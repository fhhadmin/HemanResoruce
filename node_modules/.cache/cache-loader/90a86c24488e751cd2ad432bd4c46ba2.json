{"remainingRequest":"D:\\Vue_WorkSpace\\hr-Admin\\HemanResoruce\\node_modules\\babel-loader\\lib\\index.js!D:\\Vue_WorkSpace\\hr-Admin\\HemanResoruce\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\Vue_WorkSpace\\hr-Admin\\HemanResoruce\\src\\view\\materialList\\materialList2.vue?vue&type=script&lang=js","dependencies":[{"path":"D:\\Vue_WorkSpace\\hr-Admin\\HemanResoruce\\src\\view\\materialList\\materialList2.vue","mtime":1552556793404},{"path":"D:\\Vue_WorkSpace\\hr-Admin\\HemanResoruce\\.babelrc","mtime":1551258011000},{"path":"D:\\Vue_WorkSpace\\hr-Admin\\HemanResoruce\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1551930361523},{"path":"D:\\Vue_WorkSpace\\hr-Admin\\HemanResoruce\\node_modules\\babel-loader\\lib\\index.js","mtime":1526583314000},{"path":"D:\\Vue_WorkSpace\\hr-Admin\\HemanResoruce\\node_modules\\vue-loader\\lib\\index.js","mtime":1526010763000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport index from '@/config/index';\nimport { importMaterial, getPageList, getProjectList as _getProjectList } from '@/api/materialList/materialList';\nimport { addProPlan, getProPlan, materialQuery } from '@/api/projectPlan/planList';\nimport editableTables from '_c/editableTables/editableTables';\nexport default {\n  data: function data() {\n    var _this = this;\n\n    return {\n      toolTip: '',\n      importPro: 1,\n      pageNum: 1,\n      currentPage: 1,\n      totalPages: 1,\n      isLoading: false,\n      loading: false,\n      proTable: false,\n      addProPlan: false,\n      length: 0,\n      pId: '',\n      pName: '',\n      id: '',\n      name: '',\n      planTime: '',\n      startTime: '',\n      planNum: '',\n      proId: '',\n      isShow: {\n        isExisting: false,\n        isNew: false\n      },\n      importExcel: false,\n      file: \"\",\n      existingProject: '',\n      projectName: '',\n      planGroup: [],\n      columns: [{\n        title: '序号',\n        type: 'index',\n        align: 'center'\n      }, {\n        title: '项目名称',\n        key: 'pName',\n        align: 'center'\n      }, {\n        title: '导入时间',\n        key: 'createTime',\n        align: 'center'\n      }, {\n        title: '操作',\n        key: 'action',\n        align: 'center',\n        render: function render(h, params) {\n          return h('div', [h('Button', {\n            props: {\n              type: 'info',\n              size: 'small'\n            },\n            style: {},\n            on: {\n              click: function click() {\n                _this.addProPlan = true;\n                _this.proId = params.row.pId;\n                var planList = {};\n                _this.planGroup = [];\n                _this.length = '';\n                getProPlan(_this.proId, 1, 100).then(function (res) {\n                  if (res.info.data) {\n                    res.info.data.map(function (item) {\n                      _this.length = res.info.data.length;\n                      planList = item;\n\n                      _this.planGroup.push(planList);\n                    });\n                  }\n                });\n              }\n            }\n          }, '添加计划'), h('Button', {\n            props: {\n              type: 'warning',\n              size: 'small'\n            },\n            style: {\n              marginLeft: '10px'\n            },\n            on: {\n              click: function click() {\n                _this.proTable = true;\n                _this.proId = params.row.pId;\n\n                _this.getList();\n              }\n            }\n          }, '项目用料')]);\n        }\n      }],\n      projectList: [],\n      proMaterList: [{\n        title: '序号',\n        type: 'index',\n        align: 'center'\n      }, {\n        title: '名称',\n        key: 'materName',\n        align: 'center'\n      }, {\n        title: '规格/型号',\n        key: 'materModel',\n        align: 'center'\n      }, {\n        title: '数量',\n        key: 'materNum',\n        align: 'center'\n      }, {\n        title: '单位',\n        key: 'materUnit',\n        align: 'center'\n      }, {\n        title: '已用',\n        key: 'used',\n        align: 'center'\n      }, {\n        title: '剩余',\n        key: 'surplus',\n        align: 'center'\n      }],\n      dataList: []\n    };\n  },\n  components: {\n    editableTables: editableTables\n  },\n  methods: {\n    getPageNum: function getPageNum(e) {\n      this.currentPage = e;\n    },\n    selectRow: function selectRow() {},\n    importMaterial: function importMaterial() {\n      this.importExcel = true;\n\n      if (this.importPro === 0) {\n        this.isShow.isNew = true;\n        this.isShow.isExisting = false;\n      } else if (this.importPro === 1) {\n        this.isShow.isNew = false;\n        this.isShow.isExisting = true;\n      }\n    },\n    //上传成功\n    handleSuccess: function handleSuccess(res) {\n      if (res.status === 1) {\n        this.$Message.success('上传成功');\n      } else {\n        this.$Message.error('上传失败');\n      }\n    },\n    // 获取项目列表\n    getProjectList: function getProjectList() {\n      var _this2 = this;\n\n      this.projectList = [];\n      this.isLoading = true;\n\n      _getProjectList(this.pageNum, '100').then(function (res) {\n        _this2.isLoading = false;\n\n        if (res.status === 1) {\n          _this2.projectList = res.info.data;\n        } else {\n          console.log('操作失败');\n        }\n      }).catch(function (err) {\n        console.log(err);\n      });\n    },\n    // 获取项目用料列表\n    getList: function getList() {\n      var _this3 = this;\n\n      this.loading = true;\n      this.dataList = [];\n      this.list = [];\n      getPageList(this.pageNum, this.proId).then(function (res) {\n        _this3.loading = false;\n        _this3.dataList = res.info.data;\n        _this3.totalPages = res.info.pageTotal;\n      });\n    },\n    //添加项目计划\n    addPlanOK: function addPlanOK() {\n      var _this4 = this;\n\n      this.addProPlan = false;\n      this.planTime = this.planTime.Format('yyyy-MM-dd');\n      this.startTime = this.startTime.Format('yyyy-MM-dd');\n      addProPlan(this.proId, this.planTime, this.startTime, this.planNum).then(function (res) {\n        if (res.info === '操作成功') {\n          _this4.$Message.success('计划添加成功!');\n        } else {\n          _this4.$Message.error('添加失败!');\n        }\n      });\n    },\n    addPlanCancel: function addPlanCancel() {\n      this.addProPlan = false;\n    }\n  },\n  watch: {\n    'existingProject': function existingProject(e) {\n      this.pId = e;\n    },\n    'projectName': function projectName(e) {\n      this.pName = e;\n    },\n    'importPro': function importPro(e) {\n      console.log(e);\n\n      if (e === 0) {\n        this.isShow.isNew = true;\n        this.isShow.isExisting = false;\n      } else if (e === 1) {\n        this.isShow.isExisting = true;\n        this.isShow.isNew = false;\n      }\n    }\n  },\n  mounted: function mounted() {\n    var baseUrl = index.baseUrl;\n    this.file = baseUrl.pro;\n    this.getProjectList();\n  }\n};",{"version":3,"sources":["materialList2.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAwEA;AACA;AACA;AACA;AACA;;AAEA;;;eAEA;iBACA;eACA;mBACA;kBACA;iBACA;eACA;gBACA;kBACA;cACA;WACA;aACA;UACA;YACA;gBACA;iBACA;eACA;aACA;;oBAEA;eACA,AACA;AAHA;mBAIA;YACA;uBACA;mBACA;iBACA;;eAGA;cACA;eACA,AACA;AAJA,OADA;eAOA;aACA;eACA,AACA;AAJA;eAMA;aACA;eACA,AACA;AAJA;eAMA;aACA;eACA;2CACA;;;oBAIA;oBACA,AACA;AAHA;mBAKA,AACA;;sCAEA;mCACA;yCACA;+BACA;kCACA;+BACA;oEACA;qCACA;sDACA;mDACA;iCACA;;2CACA;AACA;AAEA;AACA;AACA,AACA;AAlBA;AARA,aA2BA,OA5BA;;oBA+BA;oBACA,AACA;AAHA;;0BAKA,AACA;AAFA;;sCAIA;iCACA;yCACA;;sBACA;AACA,AACA;AANA;AARA,aAeA,AACA;AACA,AACA,AACA;AArDA;mBAsDA;;eAGA;cACA;eACA,AACA;AAJA,OADA;eAOA;aACA;eACA,AACA;AAJA;eAMA;aACA;eACA,AACA;AAJA;eAMA;aACA;eACA,AACA;AAJA;eAMA;aACA;eACA,AACA;AAJA;eAMA;aACA;eACA,AACA;AAJA;eAMA;aACA;eACA,AACA,AACA;AALA;gBAMA,AACA;AAzIA;AA0IA;;AAEA,AACA;AAFA;;uCAIA;yBACA;AACA;oCAEA,CACA;8CACA;yBACA;;gCACA;4BACA;iCACA;uCACA;4BACA;iCACA;AAEA;AACA;AACA;+CACA;4BACA;8BACA;aACA;4BACA;AACA;AACA;AACA;;AACA;;yBACA;uBACA;;+DACA;2BACA;;8BACA;wCACA;eACA;sBACA;AACA;8BACA;oBACA;AACA;AACA;AACA;;AACA;;qBACA;sBACA;kBACA;gEACA;yBACA;mCACA;qCACA;AACA;AACA;AACA;;AACA;;wBACA;2CACA;6CACA;8FACA;iCACA;kCACA;eACA;gCACA;AACA;AACA;AACA;4CACA;wBACA;AACA,AACA;AApEA;;mDAsEA;iBACA;AACA;2CACA;mBACA;AACA;uCACA;kBACA;;mBACA;4BACA;iCACA;0BACA;iCACA;4BACA;AACA;AACA,AACA;AAjBA;;AAkBA,kBACA;wBACA;SACA;AACA;AA3OA","file":"materialList2.vue","sourceRoot":"src\\view\\materialList","sourcesContent":["<template>\n  <div>\n    <editableTables :columns=\"columns\" :value=\"projectList\" :selectShow=\"false\" :pageTotal=\"totalPages\" :currentPage=\"currentPage\" @getPage=\"getPageNum\" :isLoading=\"isLoading\">\n      <Button type=\"info\" @click=\"importMaterial\">导入施工材料</Button>\n      <Button type=\"success\">导出</Button>\n    </editableTables>\n    <Modal\n      v-model=\"importExcel\"\n      title=\"施工材料导入\"\n      :mask-closable=\"false\">\n      <Select v-model=\"importPro\" style=\"margin:20px;width:120px;margin-right:0px;\">\n        <Option :value=\"0\">导入新建项目</Option>\n        <Option :value=\"1\">导入已有项目</Option>\n      </Select>\n      <Select v-model=\"existingProject\" v-if=\"isShow.isExisting\" style=\"width:200px;margin-left:0px;\" placeholder=\"请选择项目\">\n        <Option v-for=\"item in projectList\" :value=\"item.pId\" :key=\"item.pId\">{{item.pName}}</Option>\n      </Select>\n      <Input placeholder=\"请输入项目名称\" v-model=\"projectName\" v-if=\"isShow.isNew\" style=\"width:200px;margin-left:0px;\" />\n      <Upload\n        action=\"//192.168.31.19:80/admin/proMaterial/importMaterial\"\n        :data=\"{\n          pId: this.pId,\n          pName: this.pName\n        }\"\n        :on-success=\"handleSuccess\"\n        >\n      <Button icon=\"ios-cloud-upload-outline\" style=\"margin:20px\" type=\"info\">上传材料表</Button>\n    </Upload>\n    </Modal>\n    <Modal\n      title=\"项目用料表\"\n      v-model=\"proTable\"\n      :width=\"1000\">\n      <editableTables :columns=\"proMaterList\" :value=\"dataList\" :isLoading=\"loading\"></editableTables>\n    </Modal>\n    <Modal\n      v-model=\"addProPlan\"\n      :mask-closable=\"false\"\n      title=\"添加项目计划\">\n      <div style=\"margin: 20px; color:#919191;\">\n        <Tooltip>\n          <span v-if=\"this.length < 1\">已成功添加 0 个计划</span>\n          <span v-else>已成功添加 {{this.length}} 个计划</span>\n          <div slot=\"content\" v-if=\"this.length >= 1 \">\n            <span>计划时间</span>\n            <div v-for=\"item in planGroup\">\n              <p>{{item.planTime}}</p>\n            </div>\n          </div>\n          <div slot=\"content\" v-else>\n            <span>暂无计划</span>\n          </div>\n        </Tooltip>\n      </div>\n      <div style=\"margin:20px;\">\n        <!-- <span>计划时间: </span><DatePicker type=\"daterange\" v-model=\"planTime\" placeholder=\"选择计划执行时间段\" style=\"width: 200px;margin-right:20px;\"></DatePicker> -->\n        <span>计划时间: </span><DatePicker type=\"date\" v-model=\"planTime\" placeholder=\"选择计划执行时间段\" style=\"width: 200px;margin-right:20px;\"></DatePicker>\n      </div>\n      <div style=\"margin:20px;\">\n        <span>进场时间: </span><DatePicker type=\"date\" v-model=\"startTime\" placeholder=\"选择进场时间\" style=\"width: 200px;margin-right:20px;\"></DatePicker>\n      </div>\n      <div style=\"margin:20px;\">\n        <span>编 号: </span><Input v-model=\"planNum\" placeholder=\"请输入计划编号\" style=\"width:200px;\" />\n      </div>\n      <div slot=\"footer\">\n        <Button type=\"primary\" @click=\"addPlanOK\">添加</Button>\n        <Button type=\"warning\" @click=\"addPlanCancel\">取消</Button>\n      </div>\n    </Modal>\n  </div>\n</template>\n<script>\nimport index from '@/config/index'\nimport { importMaterial, getPageList, getProjectList } from '@/api/materialList/materialList'\nimport { addProPlan, getProPlan, materialQuery } from '@/api/projectPlan/planList'\nimport editableTables from '_c/editableTables/editableTables'\nexport default {\n  data(){\n    return {\n      toolTip: '',\n      importPro: 1,\n      pageNum: 1,\n      currentPage: 1,\n      totalPages: 1,\n      isLoading: false,\n      loading: false,\n      proTable: false,\n      addProPlan: false,\n      length: 0,\n      pId: '',\n      pName: '',\n      id: '',\n      name: '',\n      planTime: '',\n      startTime: '',\n      planNum: '',\n      proId: '',\n      isShow: {\n        isExisting: false,\n        isNew: false\n      },\n      importExcel: false,\n      file: \"\",\n      existingProject: '',\n      projectName: '',\n      planGroup: [],\n      columns: [\n        {\n          title: '序号',\n          type: 'index',\n          align: 'center'\n        },\n        {\n          title: '项目名称',\n          key: 'pName',\n          align: 'center'\n        },\n        {\n          title: '导入时间',\n          key: 'createTime',\n          align: 'center'\n        },\n        {\n          title: '操作',\n          key: 'action',\n          align: 'center',\n          render:(h, params) => {\n            return h('div', [\n              h('Button', {\n                props: {\n                  type: 'info',\n                  size: 'small'\n                },\n                style: {\n\n                },\n                on: {\n                  click: () => {\n                    this.addProPlan = true\n                    this.proId = params.row.pId\n                    let planList = {}\n                    this.planGroup = []\n                    this.length = ''\n                    getProPlan(this.proId, 1, 100).then(res => {\n                      if(res.info.data) {\n                        res.info.data.map(item => {\n                        this.length = res.info.data.length\n                          planList = item\n                          this.planGroup.push(planList)\n                        })\n                      }\n\n                    })\n                  }\n                }\n              }, '添加计划'),\n              h('Button', {\n                props: {\n                  type: 'warning',\n                  size: 'small'\n                },\n                style: {\n                  marginLeft: '10px'\n                },\n                on: {\n                  click: () => {\n                    this.proTable = true\n                    this.proId = params.row.pId\n                    this.getList()\n                  }\n                }\n              }, '项目用料')\n            ])\n          }\n        }\n      ],\n      projectList: [],\n      proMaterList: [\n        {\n          title: '序号',\n          type: 'index',\n          align: 'center'\n        },\n        {\n          title: '名称',\n          key: 'materName',\n          align: 'center'\n        },\n        {\n          title: '规格/型号',\n          key: 'materModel',\n          align: 'center'\n        },\n        {\n          title: '数量',\n          key: 'materNum',\n          align: 'center'\n        },\n        {\n          title: '单位',\n          key: 'materUnit',\n          align: 'center'\n        },\n        {\n          title: '已用',\n          key: 'used',\n          align: 'center'\n        },\n        {\n          title: '剩余',\n          key: 'surplus',\n          align: 'center'\n        }\n      ],\n      dataList: [],\n    }\n  },\n  components: {\n    editableTables\n  },\n  methods: {\n    getPageNum(e){\n      this.currentPage = e\n    },\n    selectRow(){\n\n    },\n    importMaterial(){\n      this.importExcel = true\n      if(this.importPro === 0) {\n        this.isShow.isNew = true\n        this.isShow.isExisting = false\n      }else if(this.importPro === 1) {\n        this.isShow.isNew = false\n        this.isShow.isExisting = true\n      }\n\n    },\n    //上传成功\n    handleSuccess(res){\n      if(res.status === 1) {\n        this.$Message.success('上传成功')\n      }else{\n        this.$Message.error('上传失败')\n      }\n    },\n    // 获取项目列表\n    getProjectList() {\n      this.projectList = []\n      this.isLoading = true\n      getProjectList(this.pageNum,'100').then(res => {\n        this.isLoading = false\n        if(res.status === 1) {\n          this.projectList = res.info.data\n        }else{\n          console.log('操作失败')\n        }\n      }).catch(err => {\n        console.log(err)\n      })\n    },\n    // 获取项目用料列表\n    getList() {\n      this.loading = true\n      this.dataList = []\n      this.list = []\n      getPageList(this.pageNum, this.proId).then(res => {\n        this.loading = false\n        this.dataList = res.info.data\n        this.totalPages = res.info.pageTotal\n      })\n    },\n    //添加项目计划\n    addPlanOK(){\n      this.addProPlan = false\n      this.planTime = this.planTime.Format('yyyy-MM-dd')\n      this.startTime = this.startTime.Format('yyyy-MM-dd')\n      addProPlan(this.proId, this.planTime, this.startTime, this.planNum).then(res => {\n        if(res.info === '操作成功'){\n          this.$Message.success('计划添加成功!')\n        }else{\n          this.$Message.error('添加失败!')\n        }\n      })\n    },\n    addPlanCancel(){\n      this.addProPlan = false\n    }\n  },\n  watch: {\n    'existingProject'(e){\n      this.pId = e\n    },\n    'projectName'(e) {\n      this.pName = e\n    },\n    'importPro' (e) {\n      console.log(e)\n      if(e === 0) {\n        this.isShow.isNew = true\n        this.isShow.isExisting = false\n      }else if(e === 1){\n        this.isShow.isExisting = true\n        this.isShow.isNew = false\n      }\n    }\n  },\n  mounted(){\n    let {baseUrl} = index\n    this.file = baseUrl.pro\n    this.getProjectList()\n  }\n}\n</script>\n<style>\n\n</style>\n"]}]}